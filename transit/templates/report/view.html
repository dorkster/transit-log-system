{% extends "base_generic.html" %}

{% block auth_content %}
<div class="container-fluid mt-4 mb-3">
    <div class="row">
        <div class="col p-1">
            <h5>Report for: <strong>{{ date_start }} - {{ date_end }}</strong></h5>
        </div>
        <div class="col-sm-auto p-1">
            <div class="btn-group" role="group">
                <a title="Previous month" class="btn btn-secondary" href="{{ month_prev }}">
                    <span class="oi oi-chevron-left"></span>
                </a>
                <a title="Next month" class="btn btn-secondary" href="{{ month_next }}">
                    <span class="oi oi-chevron-right"></span>
                </a>

            </div>
        </div>
    </div>
</div>
<hr/>
{% for v in vehicles %}
<div class="row mb-3">
    <div class="col">
{% if v.days or v.errors %}
<h3>{{ v.vehicle }}</h3>
{% endif %}
{% if v.days %}
<table class="mytable mytable-striped">
    <thead>
        <td>Date</td>
        <td>Service Miles</td>
        <td>Service Hours</td>
        <td>Deadhead Miles</td>
        <td>Deadhead Hours</td>
        <td>Passenger Miles (PMT)</td>
        <td>Fuel (gal)</td>
        {% for type in triptypes %}
        <td>Type: {{ type }}</td>
        {% endfor %}
    </thead>
    {% for day in v.days %}
    <tr>
        <td><a href="{% url 'schedule' 'edit' day.date.year day.date.month day.date.day %}">{{ day.date }}</a></td>
        <td>{{ day.service_miles }}</td>
        <td>{{ day.service_hours }}</td>
        <td>{{ day.deadhead_miles }}</td>
        <td>{{ day.deadhead_hours }}</td>
        <td>{{ day.pmt }}</td>
        <td>{{ day.fuel }}</td>
        {% for k,v in day.trip_types.items %}
        <td>{{ v }}</td>
        {% endfor %}
    </tr>
    {% endfor %}
    <thead>
        <td>Date</td>
        <td>Service Miles</td>
        <td>Service Hours</td>
        <td>Deadhead Miles</td>
        <td>Deadhead Hours</td>
        <td>Passenger Miles (PMT)</td>
        <td>Fuel (gal)</td>
        {% for type in triptypes %}
        <td>Type: {{ type }}</td>
        {% endfor %}
    </thead>
    <tr style="background: #D9EAD3; font-weight: bold;">
        <td>Total</td>
        <td>{{ v.total.service_miles }}</td>
        <td>{{ v.total.service_hours }}</td>
        <td>{{ v.total.deadhead_miles }}</td>
        <td>{{ v.total.deadhead_hours }}</td>
        <td>{{ v.total.pmt }}</td>
        <td>{{ v.total.fuel }}</td>
        {% for k,v in v.total.trip_types.items %}
        <td>{{ v }}</td>
        {% endfor %}
    </tr>
</table>
{% endif %}
{% if v.errors %}
<ul class="list-group mt-2 mb-2">
{% for error in v.errors %}
<li class="list-group-item">{{ error |safe }}</li>
{% endfor %}
</ul>
{% endif %}
    </div>
</div>
{% endfor %}
{% if no_vehicle_errors %}
<hr/>
<h3>Shifts &amp; trips without an assigned vehicle</h3>
<ul class="list-group">
{% for error in no_vehicle_errors %}
<li class="list-group-item">{{ error |safe }}</li>
{% endfor %}
</ul>
{% endif %}
{% endblock %}

{% block content %}
<p>You are not authorized. Please <a href="{% url 'login' %}?next={{ request.path }}">log in</a>.</p>
{% endblock %}
